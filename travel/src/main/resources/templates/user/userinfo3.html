<!DOCTYPE html>

<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->

<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->

<!--[if !IE]><!-->
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml"> <!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
	<meta charset="utf-8" />
	<title>Metronic | Extra - User Profile</title>
	<meta content="width=device-width, initial-scale=1.0" name="viewport" />
	<meta content="" name="description" />
	<meta content="" name="author" />
	<!-- BEGIN GLOBAL MANDATORY STYLES -->
	<link href="../media/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
	<link href="../media/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"/>
	<link href="../media/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
	<link href="../media/css/style-metro.css" rel="stylesheet" type="text/css"/>
	<link href="../media/css/style.css" rel="stylesheet" type="text/css"/>
	<link href="../media/css/style-responsive.css" rel="stylesheet" type="text/css"/>
	<link href="../media/css/default.css" rel="stylesheet" type="text/css" id="style_color"/>
	<link href="../media/css/uniform.default.css" rel="stylesheet" type="text/css"/>
	<!-- END GLOBAL MANDATORY STYLES -->
	<!-- BEGIN PAGE LEVEL STYLES -->
	<link href="../media/css/bootstrap-fileupload.css" rel="stylesheet" type="text/css" />
	<link href="../media/css/chosen.css" rel="stylesheet" type="text/css" />
	<link href="../media/css/profile.css" rel="stylesheet" type="text/css" />
	<!-- END PAGE LEVEL STYLES -->
	<link rel="shortcut icon" href="../media/image/favicon.ico" />

	<script src="../js/jquery.min.js" type="text/javascript"></script>
	<script	src="../layer/layer.js" type="text/javascript">	</script>

</head>

<body class="page-header-fixed">
	<!-- BEGIN HEADER -->
	<div class="header navbar navbar-inverse navbar-fixed-top" th:include="head.html">
	</div>
	<!-- BEGIN CONTAINER -->
	<div class="page-container row-fluid">
		<div class="page-sidebar nav-collapse collapse" th:include="left.html"></div>
		<!-- END SIDEBAR -->
		<!-- BEGIN PAGE -->
		<div class="page-content">
			<div id="portlet-config" class="modal hide">
				<div class="modal-header">
					<button data-dismiss="modal" class="close" type="button"></button>
					<h3>portlet Settings</h3>
				</div>
				<div class="modal-body">
					<p>Here will be a configuration form</p>
				</div>
			</div>
			<div class="container-fluid">
				<!-- BEGIN PAGE HEADER-->
				<div class="row-fluid">
					<div class="span12">
						<!-- 自定义 -->
						<div class="color-panel hidden-phone">
							<div class="color-mode-icons icon-color"></div>
							<div class="color-mode-icons icon-color-close"></div>
							<div class="color-mode">
								<p>THEME COLOR</p>
								<ul class="inline">
									<li class="color-black current color-default" data-style="default"></li>
									<li class="color-blue" data-style="blue"></li>
									<li class="color-brown" data-style="brown"></li>
									<li class="color-purple" data-style="purple"></li>
									<li class="color-grey" data-style="grey"></li>
									<li class="color-white color-light" data-style="light"></li>
								</ul>
								<label>
									<span>Layout</span>
									<select class="layout-option m-wrap small">
										<option value="fluid" selected>Fluid</option>
										<option value="boxed">Boxed</option>
									</select>
								</label>
								<label>
									<span>Header</span>
									<select class="header-option m-wrap small">
										<option value="fixed" selected>Fixed</option>
										<option value="default">Default</option>
									</select>
								</label>
								<label>
									<span>Sidebar</span>
									<select class="sidebar-option m-wrap small">
										<option value="fixed">Fixed</option>
										<option value="default" selected>Default</option>
									</select>
								</label>
								<label>
									<span>Footer</span>
									<select class="footer-option m-wrap small">
										<option value="fixed">Fixed</option>
										<option value="default" selected>Default</option>
									</select>
								</label>
							</div>
						</div>
						<!-- END BEGIN STYLE CUSTOMIZER -->
						<!-- BEGIN PAGE TITLE & BREADCRUMB-->
						<h3 class="page-title">
							权限管理 <small>user profile sample</small>
						</h3>
						<ul class="breadcrumb">
							<li>
								<i class="icon-home"></i>
								<a href="/index">Home</a>
								<i class="icon-angle-right"></i>
							</li>
							<li>
								<a href="#">用户管理</a>
								<i class="icon-angle-right"></i>
							</li>
							<li><a href="#">用户信息</a></li>
						</ul>
					</div>
				</div>
				<!-- BEGIN PAGE CONTENT-->
				<div class="row-fluid profile">
					<div class="span12">
						<!--BEGIN TABS-->
						<div class="tabbable tabbable-custom tabbable-full-width">
							<ul class="nav nav-tabs">
								<li class="active"><a href="#tab_1_2" data-toggle="tab">Profile Info</a></li>
								<li><a href="#tab_1_3" data-toggle="tab">Account</a></li>
							</ul>
							<div class="tab-content">
								<div class="tab-pane profile-classic row-fluid active" id="tab_1_2">
									<div class="span2"><img src="../media/image/profile-img.png" alt="" /> <a href="#" class="profile-edit">edit</a></div>
									<ul class="unstyled span10">
										<li >User Name:<span th:text="${userBean.username}"></span></li>
										<li >Email: <span th:text="${userBean.email}"></span></li>
										<li >role: <span th:text="${userBean.juese}"></span></li>
									</ul>
								</div>

								<div class="tab-pane row-fluid profile-account" id="tab_1_3">
									<div class="row-fluid">
										<div class="span12">
											<div class="span3">
												<ul class="ver-inline-menu tabbable margin-bottom-10">
													<li class="active"><a data-toggle="tab" href="#tab_1-1"><i class="icon-cog"></i>用户信息</a><span class="after"></span></li>
													<li class=""><a data-toggle="tab" href="#tab_3-3"><i class="icon-lock"></i> 修改密码</a></li>
												</ul>
											</div>
											<div class="span9">
												<div class="tab-content">
													<div id="tab_1-1" class="tab-pane active">
														<div style="height: auto;" id="accordion1-1" class="accordion collapse">
															<form >
																<label class="control-label">用户名</label><!--placeholder="John"-->
																<input th:value="${userBean.username}" type="text" readonly="readonly" id="username" class="m-wrap span8" />
																<label class="control-label">Email</label>
																<input type="text" th:value="${userBean.email}" readonly="readonly" id="email" class="m-wrap span8" />
																<label class="control-label">角色</label>

																<select id="role" th:value="${userBean.juese}">
																	<option value="普通用户">普通用户</option>
																	<option value="管理员">管理员</option>
																</select>

																<div class="submit-btn">
																	<button type="button" onclick="UpdateUser()" class="btn green">修 改</button>
																	<a href="#" class="btn">取 消</a>
																</div>
															</form>
														</div>
													</div>
													<!-- 修改密码 -->
													<div id="tab_3-3" class="tab-pane">
														<div style="height: auto;" id="accordion3-3" class="accordion collapse">
															<form action="#">
																<label class="control-label">Current Password22</label>
																<input type="password" id="currpwd" class="m-wrap span8" />
																<label class="control-label">New Password</label>
																<input type="password" id="newpwd" class="m-wrap span8" />
																<label class="control-label">Re-type New Password</label>
																<input type="password" id="renewpwd" class="m-wrap span8" />
																<div class="submit-btn">
																	<button type="button" onclick="changePass()" class="btn green">Change Password</button>
																	<a href="#" class="btn">Cancel</a>
																</div>
															</form>
														</div>
													</div>

												</div>
											</div>
											<!--end span9-->
										</div>
									</div>
								</div>
							</div>
						</div>
						<!--END TABS-->
					</div>
				</div>
				<!-- END PAGE CONTENT-->
			</div>
			<!-- END PAGE CONTAINER-->
		</div>
		<!-- END PAGE -->
	</div>
	<div class="footer">
		<div class="footer-tools">
			<span class="go-top">
			<i class="icon-angle-up"></i>
			</span>
		</div>
	</div>

	<!-- END FOOTER -->
	<!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
	<!-- BEGIN CORE PLUGINS -->
	<script src="../media/js/jquery-1.10.1.min.js" type="text/javascript"></script>
	<script src="../media/js/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>
	<!-- IMPORTANT! Load jquery-ui-1.10.1.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->
	<script src="../media/js/jquery-ui-1.10.1.custom.min.js" type="text/javascript"></script>
	<script src="../media/js/bootstrap.min.js" type="text/javascript"></script>
	<!--[if lt IE 9]>
	<script src="../media/js/excanvas.min.js"></script>
	<script src="../media/js/respond.min.js"></script>
	<![endif]-->
	<script src="../media/js/jquery.slimscroll.min.js" type="text/javascript"></script>
	<script src="../media/js/jquery.blockui.min.js" type="text/javascript"></script>
	<script src="../media/js/jquery.cookie.min.js" type="text/javascript"></script>
	<script src="../media/js/jquery.uniform.min.js" type="text/javascript" ></script>
	<!-- END CORE PLUGINS -->
	<!-- BEGIN PAGE LEVEL PLUGINS -->
	<script type="text/javascript" src="../media/js/bootstrap-fileupload.js"></script>
	<script type="text/javascript" src="../media/js/chosen.jquery.min.js"></script>
	<!-- END PAGE LEVEL PLUGINS -->
	<!-- BEGIN PAGE LEVEL SCRIPTS -->
	<script src="../../media/js/app.js"></script>
	<!-- END PAGE LEVEL SCRIPTS -->
	<script>
		jQuery(document).ready(function() {
		   App.init();
		});
		function changePass() {

			var currpwd = $("#currpwd").val();
			var newpwd = $("#newpwd").val();
            var renewpwd = $("#renewpwd").val();
            var username = $("#username").val();

            if(newpwd != renewpwd){
                layer.alert('密码不一致', {
                    skin: 'layui-layer-molv' //样式类名
                    , closeBtn: 0
                });
			}else{
                $.ajax({
                    "url": "/UpdatePwd",
                    "data": {
                        "currpwd": currpwd,
                        "newpwd": newpwd,
                        "username": username
                    },
                    "async": false,
                    "type": "get",
                    "dataType": "json",
                    "success": function (data) {
                        alert(data);
                        if(data != ''){
                            alert("111")
                            if(data == '0'){
                                layer.alert('修改失败', {
                                    skin: 'layui-layer-molv' //样式类名
                                    , closeBtn: 0
                                });
							}
							if(data == '1'){
                                layer.alert('修改成功', {
                                    skin: 'layui-layer-molv' //样式类名
                                    , closeBtn: 0
                                });
							}
							if(data == '2'){
                                layer.alert('密码错误', {
                                    skin: 'layui-layer-molv' //样式类名
                                    , closeBtn: 0
                                });
							}
							if(data == '3'){
                                layer.alert('没有该用户', {
                                    skin: 'layui-layer-molv' //样式类名
                                    , closeBtn: 0
                                });
							}

						}
                    }
                });
			}
        }
        function UpdateUser(){
            var id1 = '[[${id}]]'
			if(id1 != '') {
                //id1 = user.id;
                var name = $("#username").val();
                var email = $("#email").val();
                var role =  $("#role").val();
                console.log(name+" "+email+" "+id1+" "+role);
                $.ajax({
                    "url": "/UpdateUser1",
                    "data": {
                        "username": name,
                        "email": email,
                        "id": id1,
						"role":role
                    },
                    "async": false,
                    "type": "get",
                    "dataType": "json",
                    "success": function (data) {
                        if (data == 0) {
                            layer.alert('修改失败,用户名已存在', {
                                skin: 'layui-layer-molv' //样式类名
                                , closeBtn: 0
                            });
                        }else{
                            layer.alert('修改成功', {
                                skin: 'layui-layer-molv' //样式类名
                                , closeBtn: 0
                            });
						}
                    }
                })
            }
		}
	</script>
</body>
</html>